@model IEnumerable<RelianceMkt.Models.CustomModel.ViewGroupByShare>
@{
    ViewBag.Title = "share";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<div class="container-fluid">
    <div class="page-titles">
        <ol class="breadcrumb">
            <li class="breadcrumb-item"><a href="javascript:void(0)">Dashboard</a></li>
            <li class="breadcrumb-item active"><a href="javascript:void(0)">Share</a></li>
        </ol>
    </div>
    <!-- row -->

    <div class="row">
        <div class="col-lg-12">
            <div class="card">
                <div class="card-header">
                    <h4 class="card-title">Datewise Share Activity</h4>
                </div>
                <div class="card-body">
                    @using (Html.BeginForm("DateWiseShare", "Marketing", FormMethod.Post))
                    {
                    <div class="form-row">
                        <div class=" form-group col-md-3">
                            <label> From: </label>@Html.TextBox("fromdate", "", new { @type = "date", @class = "form-control", @Value = ViewBag.dt1.ToString("yyyy-MM-dd") })
                        </div>
                        <div class="form-group col-md-3">
                            <label> To: </label>@Html.TextBox("todate", "", new { @type = "date", @class = "form-control", @Value = ViewBag.dt2.ToString("yyyy-MM-dd") })
                        </div>
                        <div class="form-group col-md-3">
                            <label> Channel: </label>
                            @Html.DropDownList("channel", new SelectList(ViewBag.lstChannel, "channelname", "channelname"), "SELECT CHANNEL", new {  @class = "form-control" })
                        </div>
                        <div class="form-group col-md-3">
                            <label> Zone: </label>
                            @Html.DropDownList("zone", new SelectList(ViewBag.lstZone, "zonename", "zonename"), "SELECT ZONE", new {  @class = "form-control" })
                        </div>

                        <div class="col-md-3" style="padding-top:28px;">
                            <button type="submit" class="btn btn-warning ml-3">APPLY</button>
                            <button type="button" id="btnexport" class="btn btn-warning ml-3">Export To Excel</button>
                        </div>
                    </div>
                    }
                </div>
            </div>
        </div>

        <div class="col-lg-12">
            <div class="card">
                <div class="card-header">
                    <h4 class="card-title">Leads and Share Report From @Convert.ToDateTime(ViewBag.dt1).ToString("dd-MM-yyyy") To @Convert.ToDateTime(ViewBag.dt2).ToString("dd-MM-yyyy") </h4>
                </div>
                <div class="card-body">
                    <div class="table-responsive">
                        <table class="table table-responsive-md" id="table2excel">
                            <thead>
                                <tr>
                                    @*<th><strong>S NO.</strong></th>*@
                                    <th><strong>Chanel</strong></th>
                                    <th><strong>Zone</strong></th>
                                    <th><strong>SAPCODE</strong></th>
                                    <th><strong>TOTAL SHARE</strong></th>
                                    <th><strong>TOTAL LEADS</strong></th>



                                </tr>
                            </thead>
                            <tbody>
                                @{
                                    int i = 1;
                                  

                                    foreach (var item in Model)
                                    {
                                        
                                      Html.RenderAction("GetLeadRecord", "Marketing", new { @srno = i, @fd= ViewBag.dt1, @td = ViewBag.dt2, @sapcode=item.sapcode, @sharecount=item.count, @channel= ViewBag.channel, @zone= ViewBag.zone });
                                       
                                        i++;
                                    }
                                }
                                @*<tr>

                                        <td colspan="5" class="text-center">No data to display</td>

                                    </tr>*@

                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>

    </div>
</div>
@section js{
    <script src="~/Content/js/jquery.table2excel.js"></script>

    <script>
                    $("#btnexport").click(function () {
                        $("#table2excel").table2excel({
                            // exclude CSS class
                            exclude: ".noExl",
                            name: "Worksheet Name",
                            filename: "Shares", //do not include extension
                            fileext: ".xls" // file extension
                        });
                    });
    </script>
}
